<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      lang="en">
<head th:replace="~{fragment/head :: head}">
</head>
<body class="d-flex flex-column min-vh-100">
<nav th:replace="~{fragment/navbar :: navbar}"></nav>

<div class="container-fluid flex-grow-1">
    <div class="row my-2">
        <div class="col-sm-12 col-md-8 mx-auto card p-2">
            <h2
                    class="my-3 text-primary d-flex justify-content-center align-items-center">Site Setting
            </h2>
            <div class="alert"
                 th:classappend="${savedSuccessfully} ? 'alert-success' : 'alert-danger'"
                 th:if="${savingSetting}">
                <span th:text="${message}"></span>
            </div>
            <input type="hidden" th:name="${_csrf.parameterName}"
                   th:value="${_csrf.token}"/>

            <!--    Tabs Stars        -->
            <ul class="nav nav-tabs" id="settingTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="generalTab" data-bs-toggle="tab"
                            data-bs-target="#generalTabContent"
                            type="button" role="tab" aria-controls="generalTab" aria-selected="true">
                        General
                    </button>
                </li>
                <!--                <li class="nav-item" role="presentation">-->
                <!--                    <button class="nav-link" id="countriesTab" data-bs-toggle="tab"-->
                <!--                            data-bs-target="#countriesTabContent"-->
                <!--                            type="button" role="tab" aria-controls="countriesTab" aria-selected="false">-->
                <!--                        Countries-->
                <!--                    </button>-->
                <!--                </li>-->
                <!--                <li class="nav-item" role="presentation">-->
                <!--                    <button class="nav-link" id="statesTab" data-bs-toggle="tab" data-bs-target="#statesTabContent"-->
                <!--                            type="button" role="tab" aria-controls="statesTab" aria-selected="false">-->
                <!--                        States-->
                <!--                    </button>-->
                <!--                </li>-->
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="addressTab" data-bs-toggle="tab" data-bs-target="#addressTabContent"
                            type="button" role="tab" aria-controls="addressTab" aria-selected="false">
                        Address
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="mailServerTab" data-bs-toggle="tab"
                            data-bs-target="#mailServerTabContent"
                            type="button" role="tab" aria-controls="mailServerTab" aria-selected="false">
                        Mail Server
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="mailTemplateTab" data-bs-toggle="tab"
                            data-bs-target="#mailTemplateTabContent"
                            type="button" role="tab" aria-controls="mailTemplateTab" aria-selected="false">
                        Mail Templates
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="paymentTab" data-bs-toggle="tab" data-bs-target="#paymentTabContent"
                            type="button" role="tab" aria-controls="paymentTab" aria-selected="false">
                        Payment
                    </button>
                </li>
            </ul>
            <div class="tab-content" id="settingTabContent">
                <div th:replace="~{fragment/setting/generalSetting :: generalSetting(${currencies},${generalSetting})}">

                </div>
                <!--                <div th:replace="~{fragment/setting/countrySetting :: countrySetting(${countries})}">-->
                <!--                </div>-->
                <!--                <div th:replace="~{fragment/setting/stateSetting :: stateSetting(${countries},${states})}">-->
                <!--                </div>-->
                <div th:replace="~{fragment/setting/addressSetting :: addressSetting(${countries},${states})}">
                </div>
                <div th:replace="~{fragment/setting/mailServerSetting :: mailServerSetting(${mailServerSetting})}">

                </div>
                <div th:replace="~{fragment/setting/mailTemplateSetting :: mailTemplateSetting(${mailTemplateSetting})}">

                </div>
                <div class="tab-pane fade p-3" id="paymentTabContent" role="tabpanel" aria-labelledby="paymentTab">
                    Hallo
                </div>
            </div>
            <!--    Tabs Ends        -->
        </div>
    </div>
</div>

<footer th:replace="~{fragment/footer :: footer}"></footer>

</body>
<script th:src="@{/js/toastui-editor-all.min.js}"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const savedHtml = document.querySelector("#customerVerificationHiddenContent").value || "";
        const savedHtml2 = document.querySelector("#forgotPasswordHiddenContent").value || "";
        const savedHtml3 = document.querySelector("#orderConfirmationHiddenContent").value || "";

        const editor = new toastui.Editor({
            el: document.querySelector('#editor'),  // container
            height: '400px',
            initialEditType: 'wysiwyg',   // or 'wysiwyg'
            previewStyle: 'vertical'
        });


        const editor2 = new toastui.Editor({
            el: document.querySelector('#editor2'),  // container
            height: '400px',
            initialEditType: 'wysiwyg',   // or 'wysiwyg'
            previewStyle: 'vertical'
        });

        const editor3 = new toastui.Editor({
            el: document.querySelector('#editor3'),  // container
            height: '400px',
            initialEditType: 'wysiwyg',   // or 'wysiwyg'
            previewStyle: 'vertical'
        });

        // put saved content into editor
        if (savedHtml) {
            editor.setHTML(savedHtml);   // <<--- fill editor with saved HTML
        }

        if (savedHtml2) {
            editor2.setHTML(savedHtml2);   // <<--- fill editor with saved HTML
        }

        if (savedHtml3) {
            editor3.setHTML(savedHtml3);   // <<--- fill editor with saved HTML
        }

        // Refresh editor2 when its tab is shown
        document.querySelector('button[data-bs-target="#forgotPasswordTabContent"]')
            .addEventListener('shown.bs.tab', () => {
                editor2.refresh();
            });

        // Refresh editor2 when its tab is shown
        document.querySelector('button[data-bs-target="#orderConfirmationTabContent"]')
            .addEventListener('shown.bs.tab', () => {
                editor2.refresh();
            });

        // Example: get HTML or Markdown content on submit
        document.querySelector("#customerVerificationForm").addEventListener("submit", function (e) {
            // or editor.getHTML()
            document.querySelector("#customerVerificationHiddenContent").value = editor.getHTML();
        });

        // Example: get HTML or Markdown content on submit
        document.querySelector("#forgotPasswordForm").addEventListener("submit", function (e) {
            // or editor.getHTML()
            document.querySelector("#forgotPasswordHiddenContent").value = editor2.getHTML();
        });

        // Example: get HTML or Markdown content on submit
        document.querySelector("#orderConfirmationForm").addEventListener("submit", function (e) {
            // or editor.getHTML()
            document.querySelector("#orderConfirmationHiddenContent").value = editor3.getHTML();
        });
    });
</script>
</html>